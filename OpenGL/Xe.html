<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>COMP 274 - Đồ họa máy tính</title>

    <script src="js/glsim.js"></script> <!-- load the OpenGL 1.1 simulation code -->
    <script>
        frameNumber = 0;

        function transform() {
            glClear(GL_COLOR_BUFFER_BIT); // Fills the scene with blue.
            frameNumber += 1;
        }
        
        function drawTriangle(x, y, h, w, color = [255, 255, 0]) {
            glBegin(GL_POLYGON);
            glColor3ubv([255, 255, 0]);
            glVertex2f(100, 0);
            glVertex2f(0, 150);
            glVertex2f(-100, 0);
            glEnd();
        }
        
        function drawQuads(x,y,w,h, color = [255, 255, 0]) {
            glBegin(GL_QUADS);
                glColor3ubv(color);
                glVertex2f(x-w/2, y-h/2);
                glVertex2f(x-w/2, y+h/2);
                glVertex2f(x+w/2, y+h/2);
                glVertex2f(x+w/2, y-h/2);
            glEnd();
        }
        
        function drawTrapezoid(x,y,w,h,color = [255, 255, 0]) {
            glBegin(GL_QUADS);
                glColor3ubv(color);
                glVertex2f(x-(w/2)-70, y-h/2);
                glVertex2f(x-(w/2), y+h/2);
                glVertex2f(x+(w/2), y+h/2);
                glVertex2f(x+(w/2)+70, y-h/2);
            glEnd();
        }
        
        function drawCircle(x,y,r,color = [255, 0, 0]) {
            glBegin( GL_POLYGON);
            glColor3ubv(color);
            for (let i = 0; i < 64; i++) {
                let angle = (2 * Math.PI * i) / 64;  // 6.2832 represents 2*PI
                let cx = x + r/2 * Math.cos(angle);
                let cy = y + r/2 * Math.sin(angle);
                glVertex2f(cx, cy);
            }
            glEnd();
        }
        
        function drawPoints(x,y,size,color = [0, 0, 0]) {
            glPointSize(size);
            glBegin(GL_POINTS);
                glColor3ubv(color);
                glVertex2f(x,y);
            glEnd();
        }
        
        function drawMountain() {
            glBegin(GL_POLYGON);
                glColor3ubv([0, 150, 30]);
                glVertex2f(-300, -300);
                glVertex2f(-300, -70);
                glVertex2f(-170, 15);
                glVertex2f(-145, -20);
                glVertex2f(-42, 60);
                glVertex2f(103, -80);
                glVertex2f(223, -30);
                glVertex2f(300, -70);
                glVertex2f(300, -300);
            glEnd();
        }
        
        function drawRoad() {
            drawQuads(0, -150, 600, 80, [100, 100, 150]);   // Lan duong
            drawQuads(0, -150, 600, 6, [255, 255, 255]);    // Vach trang
        }
        
        function drawWinmill() {
            // Cot 1 
            drawQuads(-236, 40, 6, 180, [170, 153, 153]);
            
            // Cot 2
            drawQuads(-112, 40, 6, 120, [170, 153, 153] );
            
            // Cot 3
            drawQuads(17, 35, 6, 210, [170, 153, 153]);
        }
        
        function drawSun() {
            drawCircle(172, 181, 86, [212, 164, 112]);
            drawCircle(172, 181, 82, [255, 255, 0]);
        }
        
        /*
        funtion drawLinesAround(x, y, numSpokes, innerRadius, outerRadius, color = [167, 167, 167]) {
            glBegin(GL_LINES);
                glColor3ubv(color);
                for (let i = 0; i < numSpokes; i++) {
                    let theta = 2 * Math.PI * i / numSpokes;
                    let x1 = x + outerRadius * Math.cos(theta);
                    let y1 = y + outerRadius * Math.sin(theta);
                    let x2 = x + innerRadius * Math.cos(theta);
                    let y2 = y + innerRadius * Math.sin(theta);
                    glVertex2f(x1, y1);
                    glVertex2f(x2, y2);
                }
            glEnd();
        }
        */
        
        function drawVehicle() {
            // Banh ben trai
            drawCircle(-73, -153, 52, [0, 0, 0]);   // Vanh xe
            drawCircle(-73, -153, 43, [204, 204, 204]); // Ben trong vanh
            drawPoints(-73, -153, 10);  // Cham tron
            //drawLinesAround(-73, -153, 12, 43, 52); // Nan hoa
            
            // Banh ben phai
            drawCircle(13, -153, 52, [0, 0, 0]);    // Vanh xe
            drawCircle(13, -153, 43, [204, 204, 204]);  // Ben trong vanh
            drawPoints(13, -153, 10);   // Cham tron
            
            // Than xe
            drawQuads(-30, -120, 155, 45, [255, 0, 0]); // Than duoi
            drawQuads(-56, -86, 66, 23, [255, 0, 0]);   // Than tren
        }
        
        function draw() {
            glClear(GL_COLOR_BUFFER_BIT);
            drawMountain();
            drawRoad();
            drawVehicle();
            drawWinmill();
            drawSun();
        }

        function initGL() {
            glClearColor(0.78, 0.78, 1, 1);
            // The next three lines set up the coordinates system.
            glMatrixMode(GL_PROJECTION);
            glLoadIdentity();
            glOrtho(-300, 300, -250, 250, -1, 1);
            glMatrixMode(GL_MODELVIEW);
            glEnable(GL_POINT_SMOOTH);
        }

        function init() {  // Called by <body onload="init()">, when the page has loaded.
            try {
                glsimUse("glcanvas"); // OpenGL will draw to the canvas with id="glcanvas".
            }
            catch (e) {
                document.getElementById("canvas-holder").innerHTML =
                    "Sorry, an error occured:<br>" + e;
                return;
            }
            initGL();
            draw();
        }

        window.onload = init;

    </script>

</head>

<body>

    <h3>COMP 274 - Đồ họa máy tính</h3>

    <noscript>
        <p><b>Sorry, this page requires JavaScript!</b></p>
    </noscript>

    <div id="canvas-holder">
        <canvas id="glcanvas" width="600" height="500" style="border: solid 1px gray;"></canvas>
    </div>

</body>

</html>